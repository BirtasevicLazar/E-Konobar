<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Document</title>
    <link rel="stylesheet" href="index.css">
    <style>
        /* Dodajte ovaj CSS stil za pozicioniranje logoa u sredini ekrana */
        .loader {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        /* Dodajte ovaj stil za sakrivanje ostalog sadržaja na početku */
        #content {
            display: none;
        }
    </style>
</head>
<body>

    <div id="loader" class="loader">
        <div class="logo">
            <img src="slike/logo.png" alt="Logo">
        </div>
    </div>
    

    <div id="content" style="display: none;">
        <div class="naslov1">
            <a href="sto2.html?table=brojStola"><h1 class="naslov">-MENI PIVNICE BERLIN-</h1></a>
        </div>
    
        
        <div class="product-container">
            <!-- Proizvod 1 -->
            <div class="product">
                <img src="slike/Kafa-slika-2.jpg" alt="">
                <span class="product-name">Kafa</span>
                <span class="product-price">160 Din</span>
                <button class="add-to-cart" data-product-id="1" data-product-name="Kafa" data-product-price="160">Dodaj u korpu</button>
            </div>
        
            <!-- Proizvod 2 -->
            <div class="product">
                <img src="slike/kokakola.jpg" alt="">
                <span class="product-name">Koka Kola</span>
                <span class="product-price">210 Din</span>
                <button class="add-to-cart" data-product-id="2" data-product-name="Koka Kola" data-product-price="210">Dodaj u korpu</button>
            </div>
            <div class="product">
                <img src="slike/Kafa-slika-2.jpg" alt="">
                <span class="product-name">Kafa</span>
                <span class="product-price">160 Din</span>
                <button class="add-to-cart" data-product-id="1" data-product-name="Kafa" data-product-price="160">Dodaj u korpu</button>
            </div>
        
            <!-- Proizvod 2 -->
            <div class="product">
                <img src="slike/kokakola.jpg" alt="">
                <span class="product-name">Koka Kola</span>
                <span class="product-price">210 Din</span>
                <button class="add-to-cart" data-product-id="2" data-product-name="Koka Kola" data-product-price="210">Dodaj u korpu</button>
            </div>
            <div class="product">
                <img src="slike/Kafa-slika-2.jpg" alt="">
                <span class="product-name">Kafa</span>
                <span class="product-price">160 Din</span>
                <button class="add-to-cart" data-product-id="1" data-product-name="Kafa" data-product-price="160">Dodaj u korpu</button>
            </div>
        
            <!-- Proizvod 2 -->
            <div class="product">
                <img src="slike/kokakola.jpg" alt="">
                <span class="product-name">Koka Kola</span>
                <span class="product-price">210 Din</span>
                <button class="add-to-cart" data-product-id="2" data-product-name="Koka Kola" data-product-price="210">Dodaj u korpu</button>
            </div>
            <div class="product">
                <img src="slike/Kafa-slika-2.jpg" alt="">
                <span class="product-name">Kafa</span>
                <span class="product-price">160 Din</span>
                <button class="add-to-cart" data-product-id="1" data-product-name="Kafa" data-product-price="160">Dodaj u korpu</button>
            </div>
        
            <!-- Proizvod 2 -->
            <div class="product">
                <img src="slike/kokakola.jpg" alt="">
                <span class="product-name">Koka Kola</span>
                <span class="product-price">210 Din</span>
                <button class="add-to-cart" data-product-id="2" data-product-name="Koka Kola" data-product-price="210">Dodaj u korpu</button>
            </div>
            <div class="product">
                <img src="slike/Kafa-slika-2.jpg" alt="">
                <span class="product-name">Kafa</span>
                <span class="product-price">160 Din</span>
                <button class="add-to-cart" data-product-id="1" data-product-name="Kafa" data-product-price="160">Dodaj u korpu</button>
            </div>
        
            <!-- Proizvod 2 -->
            <div class="product">
                <img src="slike/kokakola.jpg" alt="">
                <span class="product-name">Koka Kola</span>
                <span class="product-price">210 Din</span>
                <button class="add-to-cart" data-product-id="2" data-product-name="Koka Kola" data-product-price="210">Dodaj u korpu</button>
            </div>
            <div class="product">
                <img src="slike/Kafa-slika-2.jpg" alt="">
                <span class="product-name">Kafa</span>
                <span class="product-price">160 Din</span>
                <button class="add-to-cart" data-product-id="1" data-product-name="Kafa" data-product-price="160">Dodaj u korpu</button>
            </div>
        
            <!-- Proizvod 2 -->
            <div class="product">
                <img src="slike/kokakola.jpg" alt="">
                <span class="product-name">Koka Kola</span>
                <span class="product-price">210 Din</span>
                <button class="add-to-cart" data-product-id="2" data-product-name="Koka Kola" data-product-price="210">Dodaj u korpu</button>
            </div>
            <div class="product">
                <img src="slike/Kafa-slika-2.jpg" alt="">
                <span class="product-name">Kafa</span>
                <span class="product-price">160 Din</span>
                <button class="add-to-cart" data-product-id="1" data-product-name="Kafa" data-product-price="160">Dodaj u korpu</button>
            </div>
        
            <!-- Proizvod 2 -->
            <div class="product">
                <img src="slike/kokakola.jpg" alt="">
                <span class="product-name">Koka Kola</span>
                <span class="product-price">210 Din</span>
                <button class="add-to-cart" data-product-id="2" data-product-name="Koka Kola" data-product-price="210">Dodaj u korpu</button>
            </div>
            <div class="product">
                <img src="slike/Kafa-slika-2.jpg" alt="">
                <span class="product-name">Kafa</span>
                <span class="product-price">160 Din</span>
                <button class="add-to-cart" data-product-id="1" data-product-name="Kafa" data-product-price="160">Dodaj u korpu</button>
            </div>
        
            <!-- Proizvod 2 -->
            <div class="product">
                <img src="slike/kokakola.jpg" alt="">
                <span class="product-name">Koka Kola</span>
                <span class="product-price">210 Din</span>
                <button class="add-to-cart" data-product-id="2" data-product-name="Koka Kola" data-product-price="210">Dodaj u korpu</button>
            </div>


        
        
    
        <!-- Korpa -->
        <div class="cart">
            <!-- Dugme "Plati račun" -->
            <button id="plati-racun-button">Trazi racun</button>
            <button id="pozovi-konobara-button">Pozovi konobara</button>
            <br><br>
            <h2>Korpa</h2>
            <ul id="cart-items">
                <!-- Prikazivanje stavki u korpi -->
            </ul>
            <p>Ukupna cena: <span id="total-price">0.00</span> Din</p>
    
            <button id="checkout-button">Završi kupovinu</button>
            
        </div>
    </div>

    

    <script>


// Funkcija za izvlačenje broja stola iz URL-a
// Funkcija za izvlačenje broja stola iz URL-a
// Postavite broj stola ovde
const brojStola = 2; // Zamenite 5 sa željenim brojem stola

// Funkcija za izvlačenje broja stola iz URL-a
function getTableNumberFromURL() {
    return brojStola.toString(); // Koristimo postavljeni broj stola
}

// Dodajte event listenere za oba dugmeta
const pozoviKonobaraButton = document.getElementById("pozovi-konobara-button");
const platiRacunButton = document.getElementById("plati-racun-button");

pozoviKonobaraButton.addEventListener("click", function() {
    const brojStola = getTableNumberFromURL();
    // Sada možete koristiti broj stola u kodu za slanje notifikacije
    const xhr = new XMLHttpRequest();
    xhr.open("POST", "posalji-notifikaciju.php", true);
    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    xhr.onreadystatechange = function() {
        if (xhr.readyState === 4 && xhr.status === 200) {
            const response = xhr.responseText;
            alert(response);
        }
    };
    xhr.send("broj-stola=" + brojStola);
});

platiRacunButton.addEventListener("click", function() {
    const brojStola = getTableNumberFromURL();
    // Sada možete koristiti broj stola u kodu za plaćanje računa
    const xhr = new XMLHttpRequest();
    xhr.open("POST", "plati-racun.php", true);
    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    xhr.onreadystatechange = function() {
        if (xhr.readyState === 4 && xhr.status === 200) {
            const response = xhr.responseText;
            alert(response);
        }
    };
    xhr.send("broj-stola=" + brojStola);
});

// Pozivamo funkciju za izračunavanje ukupne cene kad se stranica učita
window.addEventListener("load", calculateTotalPrice);












        window.onload = function() {
            setTimeout(function() {
                document.getElementById('loader').style.display = 'none';
                document.getElementById('content').style.display = 'block'; // Prikazivanje ostalog sadržaja
            }, 2000); // Logo će biti prikazan 2 sekunde (2000 milisekundi)
        };
    
        // Funkcija za dohvatanje podataka iz baze i dodavanje u korpu
        function getProductData(productId) {
            // Kreiranje AJAX zahteva
            const xhr = new XMLHttpRequest();
    
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    // Obrada podataka koji su stigli sa servera
                    const productData = JSON.parse(xhr.responseText);
    
                    // Dodavanje proizvoda u korpu
                    addToCart(productData);
                }
            };
    
            // Definisanje URL-a za dohvatanje podataka o proizvodu
            const url = `meni.php?ID=${productId}`; // Zamijenite sa stvarnim URL-om
    
            // Slanje AJAX zahteva
            xhr.open("GET", url, true);
            xhr.send();
        }
    
        // Funkcija za dodavanje proizvoda u korpu
        function addToCart(productData) {
    const cartItems = document.getElementById("cart-items");
    const cartItem = document.createElement("li");
    cartItem.innerHTML = `${productData.Naziv} - ${productData.Cena}`;

    // Kreirajte dugme za uklanjanje i dodajte event listener
    const removeButton = document.createElement("button");
    removeButton.textContent = " -";
    removeButton.addEventListener("click", removeProduct);

    // Dodajte element za uklanjanje uz proizvod u korpi
    cartItem.appendChild(removeButton);

    cartItems.appendChild(cartItem);
    calculateTotalPrice();
}

// Funkcija za uklanjanje proizvoda iz korpe
function removeProduct(event) {
    const cartItem = event.target.closest("li");
    cartItem.remove();
    calculateTotalPrice();
}
    
        // Dodavanje event listenera za svako dugme "Dodaj u korpu" na stranici
        const addToCartButtons = document.querySelectorAll(".add-to-cart");
        addToCartButtons.forEach(button => {
            button.addEventListener("click", function() {
                const productName = this.getAttribute("data-product-name");
                const productPrice = this.getAttribute("data-product-price");
    
                // Dodajemo proizvod u korpu
                addToCart({ Naziv: productName, Cena: productPrice });
            });
        });
    
        // Funkcija za izračunavanje ukupne cene
        function calculateTotalPrice() {
            const cartItems = document.getElementById("cart-items");
            const totalPriceElement = document.getElementById("total-price");
            const items = cartItems.querySelectorAll("li");
    
            let total = 0;
    
            items.forEach(item => {
                const itemText = item.textContent;
                const price = parseFloat(itemText.split(" - ")[1]);
                total += price;
            });
    
            // Zaokruživanje na dve decimale
            total = total.toFixed(2);
    
            // Ažuriranje prikaza ukupne cene
            totalPriceElement.textContent = total;
        }
    
        // Pozivamo funkciju za izračunavanje ukupne cene kad se stranica učita
        window.addEventListener("load", calculateTotalPrice);
    
        // Funkcija za završetak kupovine
        function checkout() {
            const cartItems = document.getElementById("cart-items");
            const items = cartItems.querySelectorAll("li");
    
            if (items.length === 0) {
                alert("Vaša korpa je prazna. Molimo vas da dodate proizvode pre nego što završite kupovinu.");
                return; // Prekidamo proces završetka kupovine
            }
    
            // Nastavljamo sa procesom završetka kupovine
            const productsInCart = [];
            items.forEach(item => {
                const itemText = item.textContent;
                const [name, price] = itemText.split(" - ");
                productsInCart.push({ Naziv: name, Cena: price });
            });
    
            const productsJson = JSON.stringify(productsInCart);
            const checkoutURL = `korpa2.html?products=${encodeURIComponent(productsJson)}`;
            window.location.href = checkoutURL;
        }
    
        // Dodajte event listener za dugme "Završi kupovinu"
        const checkoutButton = document.getElementById("checkout-button");
        checkoutButton.addEventListener("click", checkout);





        window.addEventListener('pageshow', function (event) {
        // Proverite da li se stranica ponovo prikazuje iz keša
        if (event.persisted) {
            location.reload(); // Ako da, osvežite stranicu
        }
    });
    </script>
    

    


<br>
<footer>
    <br><br><br>
        <div class="footer-content">
            <p>&copy; 2023 Moja Web Stranica</p>
        </div>
        <br><br><br>
    </footer>
        </div>

</body>
</html>
